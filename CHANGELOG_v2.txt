================================================================================
  qPCR Data Analysis Platform — v2 Update Changelog
  Date: 2026-02-14
================================================================================


========================================
  ENGLISH
========================================

BEFORE vs AFTER OVERVIEW
--------------------------------------------------------------------------------
Area              | Before                          | After
------------------|---------------------------------|------------------------------------
Navigation        | Tab-based, no progress tracking | Visual step indicator (Upload > QC > Mapping > Analysis > Graphs > Export)
Sample ordering   | Up/down buttons                 | Drag-and-drop reordering with finalize lock
Graph settings    | Scattered controls, pixel units  | Unified settings panel, centimeter (cm) units
PPT export        | Basic slides, manual text editing| Template-driven with auto-filled experiment details
Excel export      | Data sheets only                | Data + per-gene editable charts + QC report + FC matrix
UI style          | Emoji-heavy buttons and labels  | Clean, professional text-only design


NEW FEATURES
--------------------------------------------------------------------------------

1. WORKFLOW STEP INDICATOR
   A horizontal progress bar at the top of each tab shows which steps you've
   completed (Upload, QC, Mapping, Analysis, Graphs, Export) with real-time
   status updates.

2. DRAG-AND-DROP SAMPLE REORDERING
   After finalizing your sample mapping, a drag-and-drop panel appears.
   Drag samples into your preferred display order -- this order carries through
   to all graphs and exports.

   How to use:
   - Go to the Mapping tab
   - Set your condition names and groups
   - Click "Finalize Mapping"
   - Drag samples into your desired order in the panel below

3. GRAPH SETTINGS PANEL
   All graph customization in one unified "Settings & Colors" expander:
   - Figure size: Width and height sliders in cm (default 28 x 16 cm)
   - Font sizes: Global font, X-tick label, Y-axis label sizes
   - Bar style: Opacity (0.3-1.0), outline width, Y-axis min/max
   - Bar colors: Individual color picker per condition
   - Visibility toggles: Significance markers (*), error bars (+/-)
   - Gene display name: Override the gene label on Y-axis without changing data

4. REFERENCE LINE
   Select any condition (e.g., "Positive Control") to draw a dashed horizontal
   line at that expression level across the chart for easy visual comparison.
   The label shows the condition name and value, positioned to avoid overlapping
   with data.

   How to use:
   - In the Graphs tab, expand "Settings & Colors"
   - Find "Reference Line" dropdown for each gene
   - Select a condition or "None"

5. TEMPLATE-DRIVEN PPT EXPORT
   When the template file (251215 효능평가 결과 TEMPLATE.pptx) is present,
   the platform auto-fills each gene slide:
   - Gene title: "COL1A1 효능 평가"
   - Efficacy result: "효능 有" or "효능 無" (based on statistical significance)
   - Experiment details: Date, Cell line, Sample concentration, Positive control,
     Inducer, Treatment time, Test method (qPCR DDCt)

   How to use:
   - Go to the Export tab
   - Expand "Experiment Description" to set sample concentration and treatment time
   - Click "Generate PPT" -- fields are populated automatically

6. EXCEL GENE CHART SHEETS
   Each gene now gets a dedicated chart sheet ("{Gene}_Chart") with:
   - Data table: Condition, Fold_Change, SEM, p_value, significance
   - Embedded editable Excel bar chart matching the lab template format:
     * White bars with black 0.5pt outline
     * Custom SEM error bars (gray, with end caps)
     * No gridlines
     * Y-axis title: gene name in RED, housekeeping gene in black
   - Charts are fully editable in Excel -- resize, recolor, copy into
     presentations directly

7. EXCEL QC REPORT & FOLD CHANGE MATRIX
   - QC_Report sheet: Total wells, excluded wells, CT stats, triplicate
     health breakdown, CV% statistics, health score
   - FC_Matrix sheet: Pivot table of fold changes (genes x conditions)
   - Stat_Test column in gene analysis sheets showing which statistical
     test was used (e.g., "Welch t-test (n=3)")

8. NEW EFFICACY CATEGORY: Hair Root Strengthening (모근 강화)
   - Genes: VEGF, COL17A1, HGF, FGF7, FLG
   - Cell line: HFDPC / HaCaT
   - Controls: Non-treated (negative), Minoxidil (positive)


IMPROVEMENTS
--------------------------------------------------------------------------------

- Graph dimensions standardized to centimeters (default 28 x 16 cm)
- Cleaner UI: removed emoji from all buttons, labels, and status messages
- Better NaN/overflow handling in DDCt calculations (delta Ct clamped to [-50, 50])
- Auto-exclude button shows count of newly flagged wells, disables when all excluded
- QC metrics reorganized into 2-row layout for better readability
- Improved text wrapping for long condition names on X-axis
- Statistical test method now recorded per gene-condition in Excel exports
- PPT graph sizing respects cm-based figure dimensions with auto-scaling
- Condition name labels wrap properly in both Plotly graphs and Excel charts


================================================================================


========================================
  한국어
========================================

이전 버전 vs 신규 버전 비교
--------------------------------------------------------------------------------
항목              | 이전                              | 이후
------------------|-----------------------------------|------------------------------------
탐색              | 탭 기반, 진행 상태 없음             | 시각적 단계 표시기 (Upload > QC > Mapping > Analysis > Graphs > Export)
샘플 순서          | 위/아래 이동 버튼                   | 드래그앤드롭 재정렬 + 확정 잠금
그래프 설정         | 분산된 컨트롤, 픽셀 단위            | 통합 설정 패널, 센티미터(cm) 단위
PPT 내보내기       | 기본 슬라이드, 수동 텍스트 편집       | 템플릿 기반 자동 실험 정보 입력
Excel 내보내기     | 데이터 시트만                       | 데이터 + 유전자별 편집 가능한 차트 + QC 리포트 + FC 매트릭스
UI 스타일          | 이모지 다수 사용                    | 깔끔한 텍스트 전용 디자인


신규 기능
--------------------------------------------------------------------------------

1. 워크플로우 단계 표시기
   각 탭 상단에 현재 진행 상태를 보여주는 수평 진행 바가 표시됩니다.
   Upload, QC, Mapping, Analysis, Graphs, Export 6단계의 완료 여부를
   실시간으로 확인할 수 있습니다.

2. 드래그앤드롭 샘플 재정렬
   샘플 매핑을 확정(Finalize)하면 드래그앤드롭 패널이 나타납니다.
   원하는 순서로 샘플을 끌어다 놓으면 해당 순서가 모든 그래프와
   내보내기 파일에 반영됩니다.

   사용 방법:
   - Mapping 탭으로 이동
   - 조건명(Condition)과 그룹(Group) 설정
   - "Finalize Mapping" 클릭
   - 아래 패널에서 샘플을 드래그하여 원하는 순서로 정렬

3. 그래프 설정 패널
   "Settings & Colors" 확장 패널에서 모든 그래프 커스터마이징:
   - 도표 크기: cm 단위 가로/세로 슬라이더 (기본값 28 x 16 cm)
   - 글꼴 크기: 전체, X축 눈금, Y축 라벨 각각 조절
   - 바 스타일: 투명도 (0.3~1.0), 외곽선 두께, Y축 최소/최대값
   - 바 색상: 조건별 개별 색상 선택기
   - 표시 토글: 유의성 마커(*), 에러바(+/-) on/off
   - 유전자 표시명: 데이터 변경 없이 Y축 유전자명 커스터마이징

4. 기준선(Reference Line) 기능
   양성대조군 등 특정 조건을 선택하면 해당 발현량 수준에 점선 수평선이
   표시되어 시각적 비교가 용이합니다. 라벨에 조건명과 수치가 표시됩니다.

   사용 방법:
   - Graphs 탭에서 "Settings & Colors" 확장
   - 각 유전자별 "Reference Line" 드롭다운에서 조건 선택
   - "None" 선택 시 기준선 비표시

5. 템플릿 기반 PPT 내보내기
   효능평가 결과 템플릿(PPTX)이 있으면 각 유전자 슬라이드에 자동 입력:
   - 유전자 제목: "COL1A1 효능 평가"
   - 효능 판정: "효능 有" 또는 "효능 無" (통계적 유의성 기반 자동 판정)
   - 실험 세부정보: Date, Cell line, Sample concentration,
     Positive control, Inducer, Treatment time, Test method

   사용 방법:
   - Export 탭 이동
   - "Experiment Description" 펼쳐서 시료 농도, 처리 시간 입력
   - "Generate PPT" 클릭 -- 모든 필드 자동 입력됨

6. Excel 유전자별 차트 시트
   각 유전자별 전용 차트 시트 ("{Gene}_Chart") 생성:
   - 데이터 테이블: Condition, Fold_Change, SEM, p_value, significance
   - 내장 편집 가능 Excel 막대 차트 (연구소 템플릿 형식):
     * 흰색 바 + 검은 0.5pt 외곽선
     * SEM 기반 커스텀 에러바 (회색, 엔드캡 포함)
     * 격자선 없음
     * Y축 제목: 유전자명은 빨간색, 하우스키핑 유전자는 검은색
   - Excel에서 직접 편집 가능 -- 크기 조절, 색상 변경, 프레젠테이션에
     복사하여 바로 사용 가능

7. Excel QC 리포트 & Fold Change 매트릭스
   - QC_Report 시트: 전체 well 수, 제외 well, CT 통계, 삼중복 건강도, CV%
   - FC_Matrix 시트: Fold Change 피벗 테이블 (유전자 x 조건)
   - 유전자 분석 시트에 Stat_Test 컬럼 추가 (사용된 통계 검정 방법 표시)

8. 신규 효능 카테고리: 모근 강화
   - 유전자: VEGF, COL17A1, HGF, FGF7, FLG
   - 세포: HFDPC / HaCaT
   - 대조군: Non-treated (음성) / Minoxidil (양성)


개선 사항
--------------------------------------------------------------------------------

- 그래프 크기 단위를 센티미터(cm)로 통일 (기본값 28 x 16 cm)
- UI 정리: 버튼, 라벨, 상태 메시지에서 이모지 제거 -> 깔끔한 전문적 디자인
- DDCt 계산 시 NaN/오버플로우 처리 개선 (Delta Ct 값 [-50, 50] 범위 제한)
- 자동 제외 버튼: 새로 플래그된 well 수 표시, 모두 제외 시 비활성화
- QC 지표 레이아웃 2행 구성으로 가독성 향상
- X축 긴 조건명 자동 줄바꿈 처리 개선
- 통계 검정 방법이 Excel 내보내기에 유전자-조건별로 기록됨
- PPT 그래프 크기가 cm 기반 도표 치수를 따르며 자동 스케일링
- 조건명 라벨이 Plotly 그래프와 Excel 차트 모두에서 올바르게 줄바꿈됨


================================================================================
  End of Changelog
================================================================================
